# URL Shortener — README

Простой однофайловый Java CLI-сервис сокращения ссылок (файл `Main.java`). Генерирует короткие коды, хранит их в памяти, поддерживает лимит переходов и системный TTL (время жизни) ссылок, уведомления, и позволяет открывать ссылки в браузере.

---

## Кратко — как пользоваться сервисом

1. Скопируйте `Main.java` в пустую папку.
2. Скомпилируйте и запустите:

```bash
javac Main.java
java Main
```

3. После запуска появится приглашение `>` — вводите команды (см. раздел ниже).

Файл `user.uuid` будет создан при первом запуске и хранит ваш UUID (идентификатор пользователя). Если удалить этот файл — при следующем запуске будет сгенерирован новый UUID (и вы «потеряете» связь с предыдущими ссылками).

---

## Поддерживаемые команды (CLI)

* `help` — показать справку.

* `create <longUrl> [maxClicks]` — создать короткую ссылку.

  * `longUrl` — исходный URL (обязательно).
  * `maxClicks` — необязательно, `0` = без лимита.
  * В ответ программа выводит `Short code` и `Short URL` вида `http://localhost/{code}` (информативно).

* `list` — вывести список ваших ссылок с полями: код, clicks, maxClicks, active, created, url.

* `open <code-or-full-url>` — открыть ссылку в системном браузере.

  * Если передан код (например `3DZHeG`), программа найдёт запись, увеличит счётчик и откроет `longUrl`.
  * Если передан полный URL (`http://...` / `https://...`) — откроется напрямую (клики не считаются).

* `notes` — показать и очистить уведомления для текущего пользователя (например: "Ссылка X удалена по истечению TTL").

* `exit` / `quit` — выйти из программы.

---

## Как тестировать код — быстрые сценарии

### Подготовка

* Убедитесь, что у вас JDK 11+ (проверьте `java -version` и `javac -version`).
* Откройте терминал в папке с `Main.java`.
* Для быстрого теста удобнее временно уменьшить TTL: в `Main.java` найдите `DEFAULT_TTL_SECONDS` и установите, например, `60` (1 минута), затем скомпилируйте.

### Тест A — создание и открытие

1. Запустите `java Main`.
2. `create https://www.baeldung.com/java-9-http-client 3` — получите код (например `abc123`).
3. `open abc123` — браузер откроет страницу, `clicks` увеличится.
4. `list` — убедитесь, что `clicks` обновились.

### Тест B — лимит переходов (maxClicks)

1. `create https://example.com 2`.
2. Выполните `open <code>` дважды — оба раза должно открыться.
3. Третий `open <code>` должен сообщить, что ссылка неактивна.
4. `notes` — покажет уведомление об исчерпании лимита.

### Тест C — TTL (время жизни ссылки)

1. Перед тестом установите `DEFAULT_TTL_SECONDS = 60` для ускорения.
2. `create https://example.com 0` (без лимита).
3. Подождите >60 секунд.
4. `open <code>` — ссылка должна считаться просроченной и не открываться.
5. `notes` — вы увидите уведомление об удалении по истечении TTL (фоновой очисткой).

---

## Полезные примеры

* Создать ссылку с лимитом 5:

```bash
create https://example.com 5
```

* Открыть ссылку:

```bash
open 3DZHeG
```

* Показать ваши ссылки:

```bash
list
```

* Получить уведомления:

```bash
notes
```

---

## Ограничения и заметки

* Данные хранятся в памяти — при перезапуске сервера/программы все ссылки будут потеряны (UUID хранится в `user.uuid`).
* UUID — это единственный механизм идентификации пользователя (без паролей). При утрате `user.uuid` вы потеряете доступ к своим ссылкам.
* JSON-парсинг и хранение простые — для лабораторной это достаточно. Для продакшна рекомендуется подключить БД и библиотеку JSON (Jackson/Gson).
* Для тестов уменьшайте `DEFAULT_TTL_SECONDS`.

---

